import { JwtGuard } from './jwt.js';
export function jwtGuard(config) {
    return {
        async resolver(_, app) {
            const appKey = app.config.get('app.appKey').release();
            const options = {
                secret: config.secret ?? appKey,
                refreshTokenUserProvider: config.refreshTokenUserProvider,
                tokenName: config.tokenName,
                expiresIn: config.tokenExpiresIn,
                useCookies: config.useCookies,
                content: config.content,
            };
            return (ctx) => new JwtGuard(ctx, config.provider, options);
        },
    };
}
